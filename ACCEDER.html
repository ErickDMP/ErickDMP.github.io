<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="ACCEDER.css">
    <title>Acceder</title>
</head>
<body>
          <ol>
            
            
            <li><a href="index.html">Inicio</a></li>
            <li><a href="urgencias.html">Urgencias</a></li>
            <li><a href="ACCEDER.html">Acceder</a></li>
            <li><a href="dormir_con_ansiedad.html">Dormir con ansiedad</a></li>
            <li><a href="trabajar_con_ansiedad.html">Trabajar con ansiedad</a></li>
            <li><a href="interes.html">Paginas de interes</a></li>
        
          </ol>
    <body>
  <h1>Registro</h1>
  <p> Para el registro recuerda que si eres compa√±ero de clase o profesor no debes registrarte ve a iniciar sesi√≥n y sigue las instrucciones</p>
  <p>Registro "NO REQUIERE UN CORREO REAL" el correo de registro se guarda como un nuevo usuario en una base de datos de supabase y la contrase√±a tambien pero cifrada</p>
  
  <p> Contrae√±a requiere al menos 6 caracteres</p>
  <form id="signup-form">
    <input id="signup-email" type="email" placeholder="Escribe tu correo para registro" required />
    <input id="signup-password" type="password" placeholder="Escribe tu contrase√±a" required />
    <button type="submit">Registrarse</button>
  </form>

  <h1>Iniciar sesi√≥n</h1>
  <p>Si eres un compa√±ero de clase o profesor debe iniciar secci√≥n con tu nombre + @gmail.com y la clave son numeros del 1 al 6 (132456)</p>
  <p>Ejemplo usuario: profesor@gmail.com clave:12345</p>
  <p>La confirmaci√≥n de email esta desactiva por si se registra alguien</p>
  <form id="signin-form">
    <input id="signin-email" type="email" placeholder="Correo de usuario" required />
    <input id="signin-password" type="password" placeholder="Contrase√±a de usuario" required />
    <button type="submit">Entrar</button>
  </form>

  <button id="signout-btn">Cerrar sesi√≥n</button>

    <script type="module">
    import { supabase } from './supabaseziha.js'

    // Registro
    document.getElementById('signup-form').addEventListener('submit', async (e) => {
      e.preventDefault()
      const email = document.getElementById('signup-email').value
      const password = document.getElementById('signup-password').value

      const { data, error } = await supabase.auth.signUp({ email, password })
      if (error) {
        alert('Error al registrarse: ' + error.message)
      } else {
        alert('Registro exitoso üéâ')
        console.log(data)
      }
    })

  // Login
document.getElementById('signin-form').addEventListener('submit', async (e) => {
  e.preventDefault();
  const email = document.getElementById('signin-email').value;
  const password = document.getElementById('signin-password').value;

  const { data, error } = await supabase.auth.signInWithPassword({ email, password });

  if (error) {
    alert('‚ùå Error al iniciar sesi√≥n: ' + error.message);
  } else {
    alert('‚úÖ Inicio de sesi√≥n correcto');
    // Guardamos el usuario en localStorage para usarlo en perfil.html
    localStorage.setItem('user', JSON.stringify(data.user));
    // Redirige a la p√°gina de perfil
    window.location.href = 'menu_perfil.html';
  }
});


    // Logout
    document.getElementById('signout-btn').addEventListener('click', async () => {
      await supabase.auth.signOut()
      alert('Sesi√≥n cerrada üëã')
    })
  </script>
  <p> <a href="https://supabase.com/">Supabase web gratuita para crear proyectos peque√±os</a></p>
  <a href="https://supabase.com/"><img src="supabase.png"></a>
</body>
</html>