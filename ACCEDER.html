<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="ACCEDER.css">
    <title>Acceder</title>
</head>
<body>

    <body>
  <h1>Registro</h1>
  <form id="signup-form">
    <input id="signup-email" type="email" placeholder="Correo" required />
    <input id="signup-password" type="password" placeholder="ContraseÃ±a" required />
    <button type="submit">Registrarse</button>
  </form>

  <h1>Iniciar sesiÃ³n</h1>
  <p>Si eres un compaÃ±ero de clase o profesor debe iniciar secciÃ³n con tu nombre + @gmail.com y la clave son numeros del 1 al 6 (132456)</p>
  <p>Ejemplo usuario: profesor@gmail.com clave:12345</p>
  <p>La confirmaciÃ³n de email esta desactiva por si se registra alguien</p>
  <form id="signin-form">
    <input id="signin-email" type="email" placeholder="Correo" required />
    <input id="signin-password" type="password" placeholder="ContraseÃ±a" required />
    <button type="submit">Entrar</button>
  </form>

  <button id="signout-btn">Cerrar sesiÃ³n</button>

     <script type="module">
    import { supabase } from './supabaseziha.js'

    // Registro
    document.getElementById('signup-form').addEventListener('submit', async (e) => {
      e.preventDefault()
      const email = document.getElementById('signup-email').value
      const password = document.getElementById('signup-password').value

      const { data, error } = await supabase.auth.signUp({ email, password })
      if (error) {
        alert('Error al registrarse: ' + error.message)
      } else {
        alert('Registro exitoso ğŸ‰')
        console.log(data)
      }
    })

  // Login
document.getElementById('signin-form').addEventListener('submit', async (e) => {
  e.preventDefault();
  const email = document.getElementById('signin-email').value;
  const password = document.getElementById('signin-password').value;

  const { data, error } = await supabase.auth.signInWithPassword({ email, password });

  if (error) {
    alert('âŒ Error al iniciar sesiÃ³n: ' + error.message);
  } else {
    alert('âœ… Inicio de sesiÃ³n correcto');
    // Guardamos el usuario en localStorage para usarlo en perfil.html
    localStorage.setItem('user', JSON.stringify(data.user));
    // Redirige a la pÃ¡gina de perfil
    window.location.href = 'menu_perfil.html';
  }
});


    // Logout
    document.getElementById('signout-btn').addEventListener('click', async () => {
      await supabase.auth.signOut()
      alert('SesiÃ³n cerrada ğŸ‘‹')
    })
  </script>
</body>
</html>